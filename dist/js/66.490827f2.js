"use strict";(self["webpackChunkwebrtc_vue"]=self["webpackChunkwebrtc_vue"]||[]).push([[66],{6727:function(e,s,t){t.r(s),t.d(s,{default:function(){return z}});var n=t(3396),i=t(7139),o=t(9242),c=t(9289),a=t(162),r=t(5427);const g=e=>((0,n.dD)("data-v-56433d13"),e=e(),(0,n.Cn)(),e),l={class:"chatbot-container"},h=["onClick"],d={key:1,class:(0,i.C_)({"chat-bubble":!0,sender:!0})},u={class:"message-input-container"},p={class:"icon-buttons-container"},w=["disabled"],b=g((()=>(0,n._)("img",{src:c,alt:""},null,-1))),m=[b],x=["disabled"],T=g((()=>(0,n._)("img",{src:a,alt:""},null,-1))),k=[T],f=g((()=>(0,n._)("img",{src:r,alt:""},null,-1))),v=[f];function M(e,s,t,c,a,r){return(0,n.wg)(),(0,n.iD)("div",l,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.messages,((e,s)=>((0,n.wg)(),(0,n.iD)("div",{key:s,class:"chat-window"},[(0,n._)("div",{class:(0,i.C_)({"sender-chat-box":"user"===e.sender,"receiver-chat-box":"bot"===e.sender})},["bot"===e.sender?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,i.C_)({"chat-bubble":!0,receiver:!0}),onClick:s=>r.speakMessage(e.text)},(0,i.zw)(e.text),9,h)):((0,n.wg)(),(0,n.iD)("div",d,(0,i.zw)(e.text),1))],2)])))),128)),(0,n._)("div",u,[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>a.newMessageText=e),placeholder:"请输入您的问题...",onKeyup:s[1]||(s[1]=(0,o.D2)(((...e)=>r.sendMessage&&r.sendMessage(...e)),["enter"]))},null,544),[[o.nr,a.newMessageText]]),(0,n._)("div",p,[(0,n._)("button",{onClick:s[2]||(s[2]=(...e)=>r.startSpeechRecognition&&r.startSpeechRecognition(...e)),disabled:a.isRecognizing,class:"icon-button"},m,8,w),(0,n._)("button",{onClick:s[3]||(s[3]=(...e)=>r.stopSpeechRecognition&&r.stopSpeechRecognition(...e)),disabled:!a.isRecognizing,class:"icon-button"},k,8,x),(0,n._)("button",{type:"submit",class:"icon-button",onClick:s[4]||(s[4]=(...e)=>r.sendMessage&&r.sendMessage(...e))},v)])])])}t(7658);var R={name:"chatVue",data(){return{messages:[{sender:"bot",text:"您好，我是 ChatGPT。请问有什么可以帮您的？"},{sender:"user",text:"您好，我是 ChatGPT。请问有什么可以帮您的？"}],newMessageText:"",finalTranscript:"",isRecognizing:!1,recognition:null,socket:null,loadingMessageIndex:null,interimTranscript:""}},methods:{init(){this.socket=window.io(),this.socket.on("connect",(()=>{console.log("connect")})),this.socket.on("chatGPT",(e=>{this.messages.splice(this.loadingMessageIndex,1),this.messages.push({sender:"bot",text:e})}))},async sendMessage(){if(await this.stopSpeechRecognition(),this.isRecognizing=!1,setTimeout((()=>{this.newMessageText="",this.finalTranscript=""}),100),""!==this.newMessageText){this.messages.push({sender:"user",text:this.newMessageText});const e=this.messages[this.messages.length-1].text;this.messages.push({sender:"bot",text:"正在回答问题，请稍等..."}),this.loadingMessageIndex=this.messages.length-1,this.socket.emit("chatGPT",e),console.log(this.newMessageText)}},startSpeechRecognition(){this.recognition=new window.webkitSpeechRecognition,this.recognition.continuous=!0,this.recognition.lang="zh-CN",this.recognition.onresult=e=>{this.interimTranscript="";for(let s=e.resultIndex;s<e.results.length;s++){const t=e.results[s][0].transcript;e.results[s].isFinal?this.finalTranscript+=t:this.interimTranscript+=t}this.newMessageText=this.finalTranscript+this.interimTranscript},this.recognition.onend=()=>{this.isRecognizing=!1,this.finalTranscript=""},this.recognition.start(),this.isRecognizing=!0},stopSpeechRecognition(){console.log("1"),this.isRecognizing&&(this.recognition.stop(),this.isRecognizing=!1)},speakMessage(e){let s=new SpeechSynthesisUtterance(e);window.speechSynthesis.speak(s)}},mounted(){this.init(),setInterval((()=>{console.log(this.isRecognizing),console.log(this.finalTranscript),console.log(this.newMessageText),console.log(this.interimTranscript)}),1e4)}},_=t(89);const C=(0,_.Z)(R,[["render",M],["__scopeId","data-v-56433d13"]]);var z=C},162:function(e,s,t){e.exports=t.p+"img/mic-off.d19f90ec.svg"},9289:function(e,s,t){e.exports=t.p+"img/mic.6d1a8104.svg"},5427:function(e,s,t){e.exports=t.p+"img/send.5a21e539.svg"}}]);
//# sourceMappingURL=66.490827f2.js.map